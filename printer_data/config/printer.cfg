[include fluidd.cfg]
[include ebb36.cfg]
[exclude_object]
[pause_resume]

[virtual_sdcard]
path: /home/biqu/printer_data/gcodes
on_error_gcode: CANCEL_PRINT
# This file contains common pin mappings for the BigTreeTech Octopus.
# To use this config, the firmware should be compiled for the
# STM32F446 with a "32KiB bootloader" and a "12MHz crystal" clock reference.

[mcu]
serial: /dev/serial/by-id/usb-Klipper_stm32f446xx_2C005C000251313133353932-if00
# CAN bus is also available on this board

[temperature_sensor mcu_temp]
sensor_type: temperature_mcu

[temperature_sensor btt_pi]
sensor_type: temperature_host

[printer]
kinematics: corexy
max_velocity: 600  
max_accel: 15000 
max_z_velocity: 10
max_z_accel: 100
square_corner_velocity: 10

[board_pins] 	# EXP1 / EXP2 (display) pins
aliases:
    # EXP1 header
    EXP1_1=PE8, EXP1_2=PE7,
    EXP1_3=PE9, EXP1_4=PE10,
    EXP1_5=PE12, EXP1_6=PE13,    # Slot in the socket on this side
    EXP1_7=PE14, EXP1_8=PE15,
    EXP1_9=<GND>, EXP1_10=<5V>,

    # EXP2 header
    EXP2_1=PA6, EXP2_2=PA5,
    EXP2_3=PB1, EXP2_4=PA4,
    EXP2_5=PB2, EXP2_6=PA7,      # Slot in the socket on this side
    EXP2_7=PC15, EXP2_8=<RST>,
    EXP2_9=<GND>, EXP2_10=<5V>


[stepper_x]
step_pin: PG0
dir_pin: !PG1
enable_pin: !PF15
microsteps: 16
rotation_distance: 40
endstop_pin: !EBBCan: PB8
position_endstop: 0 #it needs to be 350 not 0, its inversed
position_max: 380
homing_speed: 100

[stepper_y]
step_pin: PF13
dir_pin: PF12
enable_pin: !PF14
microsteps: 16
rotation_distance: 40
endstop_pin: ^PG9
position_endstop: 0 #it needs to be 350 not 0, its inversed
position_max: 350
homing_speed: 100

[tmc2209 stepper_y]
uart_pin: PD11
#diag_pin: PG9
run_current: 0.7
interpolate: False
#stealthchop_threshold: 999999
[tmc2209 stepper_x]
uart_pin: PC4
#diag_pin: PG6
run_current: 0.77
interpolate: False
#stealthchop_threshold: 999999


[stepper_z]
step_pin: PE2
dir_pin: !PE3
enable_pin: !PD4
microsteps: 16
rotation_distance: 4
endstop_pin: probe:z_virtual_endstop
position_max: 400
position_min: -3
homing_speed: 10.0

[tmc2209 stepper_z]
uart_pin: PE1
run_current: 0.650
#stealthchop_threshold: 999999


[stepper_z1]
step_pin: PE6
dir_pin: !PA14
enable_pin: !PE0
microsteps: 16 #128 #16
rotation_distance: 4
#endstop_pin: probe:z_virtual_endstop
#position_max: 400
#position_min: 0
#homing_speed: 10.0


[tmc2209 stepper_z1]
uart_pin: PD3
run_current: 0.650
#stealthchop_threshold: 999999

[safe_z_home]
home_xy_position: 180, 180 # Choose an X,Y position that is in the center of your bed. For a 300x300 machine that will be 150, 150. Use the same principle to calculate your bed center.
z_hop: 10
z_hop_speed: 25
speed: 200

[z_tilt]
z_positions: -18.4,180
             378.4,180

# A list of X,Y coordinates (one per line; subsequent lines
# indented) describing the location of each bed "pivot point". The
# "pivot point" is the point where the bed attaches to the given Z
# stepper. It is described using nozzle coordinates (the XY position
# of the nozzle if it could move directly above the point). The
# first entry corresponds to stepper_z, the second to stepper_z1,
# the third to stepper_z2, etc. This parameter must be provided.

points: 300,180
        30,180

# A list of X,Y coordinates (one per line; subsequent lines | back |
# indented) that should be probed during a Z_TILT_ADJUST command. | |
# Specify coordinates of the nozzle and be sure the probe is above L z1 z R
# the bed at the given nozzle coordinates. This parameter must be | |
# provided. | front |

speed: 50
horizontal_move_z: 5
retries: 5

# Number of times to retry if the probed points aren't within
# tolerance.

retry_tolerance:0.01

# If retries are enabled then retry if largest and smallest probed
# points differ more than retry_tolerance. Note the smallest unit of
# change here would be a single step. However if you are probing
# more points than steppers then you will likely have a fixed
# minimum value for the range of probed points which you can learn
# by observing command output.

[heater_bed]
heater_pin: PA1
sensor_pin: PF3 # TB
sensor_type: EPCOS 100K B57560G104F
control: pid
pid_Kp: 690.34
pid_Ki: 111.47
pid_Kd: 1068.83
min_temp: 0
max_temp: 130

[heater_fan fan2]
pin: PD12

[heater_fan fan3]
pin: PD13

#*# <---------------------- SAVE_CONFIG ---------------------->
#*# DO NOT EDIT THIS BLOCK OR BELOW. The contents are auto-generated.
#*#
#*# [bed_mesh default]
#*# version = 1
#*# points =
#*# 	-0.242986, -0.209263, -0.171357, -0.153447, -0.150656, -0.134257, -0.119299, -0.112965, -0.103321, -0.116038, -0.129466, -0.128217, -0.135730, -0.158002, -0.128254, -0.131623, -0.116563, -0.124616, -0.132096, -0.143987, -0.147030, -0.139391, -0.175361, -0.202909, -0.220866, -0.239802, -0.262570, -0.281571, -0.290737, -0.327207
#*# 	-0.242870, -0.204162, -0.171625, -0.144434, -0.138228, -0.113114, -0.082636, -0.084617, -0.087506, -0.104406, -0.098063, -0.090135, -0.108656, -0.137863, -0.125014, -0.088267, -0.080622, -0.109007, -0.116643, -0.097001, -0.109970, -0.142340, -0.156707, -0.155313, -0.169188, -0.195512, -0.233548, -0.270830, -0.268203, -0.293168
#*# 	-0.198816, -0.187779, -0.162576, -0.146297, -0.088952, -0.069860, -0.094522, -0.087387, -0.061953, -0.054047, -0.064589, -0.092144, -0.094522, -0.085177, -0.078835, -0.085177, -0.078835, -0.075663, -0.064730, -0.078552, -0.101034, -0.098552, -0.119409, -0.142997, -0.180616, -0.192930, -0.200912, -0.226857, -0.271600, -0.289797
#*# 	-0.210633, -0.170322, -0.126995, -0.131212, -0.121483, -0.071877, -0.055179, -0.039367, -0.041723, -0.058427, -0.063127, -0.032643, -0.058658, -0.058999, -0.068972, -0.037912, -0.036569, -0.049743, -0.068198, -0.057655, -0.043353, -0.058224, -0.085053, -0.119359, -0.132411, -0.146389, -0.194399, -0.218337, -0.216773, -0.262424
#*# 	-0.154451, -0.138952, -0.128218, -0.100385, -0.059028, -0.043215, -0.045849, -0.034582, -0.018356, -0.014860, -0.027353, -0.034582, -0.045447, -0.034758, -0.027353, -0.037619, -0.029143, -0.025260, -0.022162, -0.038467, -0.059123, -0.068522, -0.064395, -0.102385, -0.119748, -0.147317, -0.147317, -0.187544, -0.223864, -0.244661
#*# 	-0.173495, -0.124009, -0.095545, -0.091009, -0.077093, -0.059062, -0.018942, -0.007311, -0.022408, -0.021809, -0.026767, 0.000675, -0.013049, -0.018780, -0.017496, 0.001960, 0.002832, -0.003776, -0.027117, -0.011531, -0.036104, -0.029137, -0.060103, -0.080279, -0.096406, -0.105631, -0.136770, -0.187862, -0.188730, -0.210650
#*# 	-0.131410, -0.110526, -0.104286, -0.067232, -0.037570, -0.019735, -0.033168, -0.013998, 0.003203, 0.007079, 0.001345, -0.013536, -0.005397, -0.002646, -0.003652, -0.004988, -0.001408, 0.012258, -0.004889, -0.022482, -0.032849, -0.041880, -0.038680, -0.071675, -0.101754, -0.121208, -0.111065, -0.154587, -0.201574, -0.217936
#*# 	-0.145807, -0.112640, -0.078279, -0.055814, -0.052101, -0.019444, -0.001233, 0.017447, 0.027217, 0.014182, 0.009775, 0.015398, 0.038204, 0.017603, -0.000452, 0.026024, 0.031676, 0.022554, -0.004615, 0.006234, 0.007723, 0.001121, -0.042199, -0.058915, -0.057851, -0.088237, -0.120487, -0.138677, -0.144473, -0.181806
#*# 	-0.126627, -0.077168, -0.064863, -0.047753, -0.014349, 0.007729, 0.005482, 0.014789, 0.024403, 0.041241, 0.032826, 0.018541, 0.022199, 0.038435, 0.035629, 0.026873, 0.038198, 0.009115, 0.016954, 0.009275, -0.008083, -0.015443, -0.037691, -0.052642, -0.064403, -0.075933, -0.103075, -0.120807, -0.150556, -0.184038
#*# 	-0.133272, -0.094400, -0.053422, -0.011728, -0.013523, 0.006664, 0.012351, 0.050398, 0.036310, 0.031398, 0.032004, 0.053462, 0.050948, 0.039819, 0.023589, 0.050957, 0.065579, 0.042636, 0.015168, 0.020180, 0.019478, 0.015774, -0.017215, -0.052073, -0.057902, -0.056359, -0.110937, -0.124344, -0.115355, -0.137755
#*# 	-0.124041, -0.075453, -0.073406, -0.034331, -0.011767, 0.011151, 0.018364, 0.020922, 0.037580, 0.038186, 0.038190, 0.041089, 0.053422, 0.048817, 0.046006, 0.043198, 0.040387, 0.055405, 0.015741, 0.009970, 0.007259, 0.010127, -0.013824, -0.061938, -0.084060, -0.105550, -0.104025, -0.112122, -0.149898, -0.182470
#*# 	-0.157550, -0.141973, -0.082627, -0.051537, -0.042519, -0.023250, 0.014927, 0.023348, 0.033976, 0.030560, 0.033973, 0.037394, 0.036993, 0.020275, 0.030288, 0.041514, 0.058947, 0.038708, 0.019062, 0.003285, -0.024752, 0.008877, -0.031871, -0.067019, -0.092031, -0.091749, -0.113314, -0.131513, -0.140883, -0.164916
#*# 	-0.151859, -0.118422, -0.089542, -0.059921, -0.025162, -0.002853, 0.005129, 0.004472, 0.022071, 0.035504, 0.034885, 0.022008, 0.034885, 0.040497, 0.045506, 0.032079, 0.048312, 0.034885, 0.018137, 0.003466, -0.032807, -0.014848, -0.052511, -0.086445, -0.114039, -0.114614, -0.118004, -0.141734, -0.176253, -0.197662
#*# 	-0.168893, -0.137250, -0.102107, -0.067732, -0.042645, -0.019964, 0.017528, 0.023749, 0.033820, 0.015331, 0.037177, 0.030664, 0.037073, 0.016628, 0.024445, 0.032864, 0.043391, 0.032864, 0.021029, 0.001540, 0.003285, -0.012557, -0.031271, -0.086479, -0.110331, -0.102987, -0.114208, -0.114783, -0.171178, -0.180631
#*# 	-0.147395, -0.117538, -0.072094, -0.059951, -0.037326, 0.000673, -0.010788, 0.020000, 0.005787, 0.032723, 0.017095, 0.027059, 0.036820, 0.013390, 0.018398, 0.022852, 0.015593, 0.007734, 0.001380, -0.021364, -0.023987, -0.032371, -0.070577, -0.088389, -0.117391, -0.120074, -0.137676, -0.150308, -0.197030, -0.196821
#*# 	-0.149762, -0.127193, -0.104299, -0.064871, -0.056320, -0.036715, 0.000327, 0.002577, 0.011699, 0.015540, 0.009191, 0.017018, 0.002336, 0.022027, -0.010870, 0.016408, 0.010460, 0.017022, -0.021493, -0.024124, -0.024006, -0.035132, -0.061797, -0.095631, -0.116158, -0.132094, -0.141087, -0.144920, -0.169748, -0.196821
#*# 	-0.167992, -0.123782, -0.099157, -0.063238, -0.062099, -0.038839, -0.030407, -0.021657, -0.008570, 0.004517, -0.011279, -0.005706, -0.013680, -0.010054, -0.018186, -0.024634, -0.002079, -0.012919, -0.026394, -0.034782, -0.036081, -0.050759, -0.075348, -0.114637, -0.133111, -0.141519, -0.141151, -0.187305, -0.204289, -0.216161
#*# 	-0.165429, -0.138525, -0.110370, -0.079485, -0.066702, -0.056841, -0.030970, -0.021841, -0.005257, -0.022981, -0.021973, -0.013385, -0.019829, -0.021973, -0.027699, -0.033506, -0.014445, -0.023967, -0.031606, -0.046468, -0.038379, -0.049789, -0.058483, -0.116833, -0.137080, -0.145786, -0.140337, -0.179848, -0.205545, -0.228862
#*# 	-0.154592, -0.116732, -0.105679, -0.084944, -0.064187, -0.068316, -0.035188, -0.034544, -0.021247, -0.024110, -0.017416, -0.022256, -0.033332, -0.016287, -0.035448, -0.029363, -0.026500, -0.034681, -0.046007, -0.058496, -0.063755, -0.068296, -0.101459, -0.119368, -0.137549, -0.160579, -0.156720, -0.200130, -0.226671, -0.247371
#*# 	-0.155820, -0.140937, -0.092288, -0.082114, -0.073686, -0.061645, -0.042306, -0.024186, -0.022858, -0.023113, -0.034895, -0.014497, -0.027739, -0.040580, -0.046345, -0.032833, -0.031548, -0.031548, -0.044707, -0.073691, -0.074383, -0.071219, -0.080711, -0.116775, -0.148718, -0.161157, -0.166916, -0.194921, -0.226771, -0.257459
#*# 	-0.171281, -0.141628, -0.111589, -0.088138, -0.084973, -0.073976, -0.048873, -0.036105, -0.035182, -0.031411, -0.042954, -0.042296, -0.044927, -0.045491, -0.060712, -0.047802, -0.046875, -0.048366, -0.068858, -0.073374, -0.086939, -0.096435, -0.109776, -0.144958, -0.155708, -0.168639, -0.182259, -0.224218, -0.260264, -0.275561
#*# 	-0.193088, -0.159151, -0.137309, -0.106990, -0.106481, -0.108797, -0.066475, -0.058012, -0.049369, -0.050684, -0.063841, -0.061207, -0.057261, -0.059665, -0.078619, -0.072289, -0.057852, -0.064892, -0.084266, -0.073647, -0.100775, -0.088624, -0.109591, -0.146020, -0.156138, -0.169236, -0.195551, -0.222102, -0.273681, -0.294110
#*# 	-0.206506, -0.183096, -0.137471, -0.113543, -0.104690, -0.095196, -0.083094, -0.054929, -0.060189, -0.076505, -0.077472, -0.060764, -0.086003, -0.089850, -0.096970, -0.080455, -0.070962, -0.092433, -0.103678, -0.102605, -0.111201, -0.108933, -0.132351, -0.157886, -0.189252, -0.206088, -0.233788, -0.239703, -0.298313, -0.310786
#*# 	-0.220007, -0.177893, -0.153844, -0.137322, -0.108131, -0.098470, -0.073152, -0.064722, -0.032221, -0.062091, -0.065294, -0.079482, -0.079482, -0.088976, -0.096582, -0.108561, -0.086410, -0.077707, -0.086410, -0.113565, -0.119502, -0.120406, -0.117777, -0.158656, -0.213331, -0.231695, -0.223946, -0.239521, -0.285357, -0.314626
#*# 	-0.213186, -0.207002, -0.151416, -0.132238, -0.128980, -0.111372, -0.087096, -0.057813, -0.070483, -0.088826, -0.079841, -0.076846, -0.112934, -0.118293, -0.125813, -0.105333, -0.092669, -0.104650, -0.115037, -0.115468, -0.128296, -0.135182, -0.169106, -0.195151, -0.198945, -0.229667, -0.247410, -0.266817, -0.304321, -0.329977
#*# 	-0.240274, -0.221804, -0.181741, -0.161659, -0.139220, -0.124860, -0.112895, -0.097593, -0.094428, -0.097593, -0.107088, -0.115574, -0.117683, -0.118026, -0.137643, -0.147210, -0.124821, -0.108391, -0.114668, -0.137640, -0.138587, -0.139509, -0.161627, -0.185845, -0.235367, -0.245112, -0.236073, -0.274875, -0.306872, -0.337570
#*# 	-0.269691, -0.229428, -0.197131, -0.167173, -0.179405, -0.146047, -0.125643, -0.119395, -0.109802, -0.121500, -0.135865, -0.141217, -0.122076, -0.158097, -0.165138, -0.162724, -0.134905, -0.139206, -0.154002, -0.151056, -0.156826, -0.163045, -0.192418, -0.195557, -0.224197, -0.250983, -0.270352, -0.293106, -0.323756, -0.365301
#*# 	-0.257422, -0.228285, -0.212583, -0.193991, -0.170628, -0.147626, -0.133612, -0.124994, -0.135717, -0.113757, -0.133036, -0.126148, -0.143760, -0.137968, -0.148368, -0.155644, -0.152847, -0.134973, -0.121182, -0.144533, -0.178716, -0.166492, -0.164637, -0.202908, -0.252078, -0.276738, -0.254623, -0.267603, -0.317534, -0.366088
#*# 	-0.265063, -0.235503, -0.196656, -0.179518, -0.167285, -0.180909, -0.144828, -0.106368, -0.142724, -0.129319, -0.137109, -0.127546, -0.129644, -0.153602, -0.168545, -0.163990, -0.142470, -0.151758, -0.171364, -0.164139, -0.159761, -0.170601, -0.201279, -0.231406, -0.251812, -0.249272, -0.277401, -0.326736, -0.349433, -0.362736
#*# 	-0.266485, -0.246247, -0.237946, -0.208758, -0.200218, -0.178883, -0.157862, -0.140267, -0.135852, -0.138926, -0.154625, -0.162565, -0.158385, -0.149850, -0.173409, -0.181021, -0.174556, -0.158290, -0.155855, -0.195170, -0.203136, -0.186598, -0.193658, -0.214331, -0.274302, -0.294475, -0.275539, -0.282138, -0.334362, -0.385569
#*# tension = 0.2
#*# min_x = 40.0
#*# algo = bicubic
#*# y_count = 30
#*# mesh_y_pps = 3
#*# min_y = 5.0
#*# x_count = 30
#*# max_y = 304.85999999999996
#*# mesh_x_pps = 3
#*# max_x = 349.71999999999997
#*#
#*# [probe_eddy_current btt_eddy]
#*# reg_drive_current = 16
#*# calibrate =
#*# 	0.050000:3184580.410,0.090000:3184214.797,0.130000:3183870.696,
#*# 	0.170000:3183531.360,0.210000:3183161.530,0.250000:3182823.630,
#*# 	0.290000:3182503.812,0.330000:3182183.933,0.370000:3181846.898,
#*# 	0.410000:3181543.250,0.450000:3181243.751,0.490000:3180874.379,
#*# 	0.530000:3180594.932,0.570000:3180289.104,0.610000:3179988.865,
#*# 	0.650000:3179675.759,0.690000:3179397.225,0.730000:3179102.383,
#*# 	0.770000:3178839.133,0.810000:3178539.539,0.850000:3178246.774,
#*# 	0.890000:3177951.025,0.930000:3177660.962,0.970000:3177377.371,
#*# 	1.010000:3177117.110,1.050000:3176847.008,1.090000:3176586.525,
#*# 	1.130000:3176350.331,1.170000:3176112.222,1.210000:3175871.057,
#*# 	1.250000:3175632.000,1.290000:3175404.128,1.330000:3175174.654,
#*# 	1.370000:3174937.699,1.410000:3174728.314,1.450000:3174481.011,
#*# 	1.490000:3174268.620,1.530000:3174050.829,1.570000:3173846.593,
#*# 	1.610000:3173635.766,1.650000:3173423.150,1.690000:3173230.757,
#*# 	1.730000:3173034.866,1.770000:3172835.607,1.810000:3172638.055,
#*# 	1.850000:3172432.637,1.890000:3172247.511,1.930000:3172084.274,
#*# 	1.970000:3171897.927,2.010000:3171751.905,2.050000:3171579.342,
#*# 	2.090000:3171433.339,2.130000:3171248.825,2.170000:3171076.789,
#*# 	2.210000:3170944.362,2.250000:3170775.455,2.290000:3170636.883,
#*# 	2.330000:3170465.689,2.370000:3170331.607,2.410000:3170180.754,
#*# 	2.450000:3170033.265,2.490000:3169880.847,2.530000:3169774.570,
#*# 	2.570000:3169629.602,2.610000:3169482.007,2.650000:3169354.727,
#*# 	2.690000:3169209.638,2.730000:3169084.325,2.770000:3168959.861,
#*# 	2.810000:3168830.514,2.850000:3168705.987,2.890000:3168561.129,
#*# 	2.930000:3168448.595,2.970000:3168310.622,3.010000:3168167.474,
#*# 	3.050000:3168049.716,3.090000:3167919.982,3.130000:3167812.640,
#*# 	3.170000:3167694.703,3.210000:3167581.327,3.250000:3167470.429,
#*# 	3.290000:3167375.434,3.330000:3167228.317,3.370000:3167133.894,
#*# 	3.410000:3167026.741,3.450000:3166926.565,3.490000:3166819.616,
#*# 	3.530000:3166667.567,3.570000:3166589.845,3.610000:3166489.050,
#*# 	3.650000:3166386.328,3.690000:3166287.745,3.730000:3166179.367,
#*# 	3.770000:3166099.932,3.810000:3165997.216,3.850000:3165893.315,
#*# 	3.890000:3165808.786,3.930000:3165719.182,3.970000:3165627.011,
#*# 	4.010000:3165550.260,4.050000:3165462.024
#*#
#*# [temperature_probe btt_eddy]
#*# calibration_temp = 58.596411
#*# drift_calibration =
#*# 	3247239.401259, -1455.922198, 10.563392
#*# 	3234087.675752, -1273.726371, 9.274413
#*# 	3222914.683643, -1091.305298, 7.798529
#*# 	3212425.856215, -892.761952, 6.183087
#*# 	3205080.977181, -777.999476, 5.323373
#*# 	3196895.537571, -598.562044, 3.786936
#*# 	3190666.663896, -472.225937, 2.720511
#*# 	3187088.834595, -432.404661, 2.490508
#*# 	3183229.333517, -364.611060, 1.963077
#*# drift_calibration_min_temp = 42.104458349284265
